{
    "copilot_instructions": {
        "title": "DroidNet — Copilot Instructions",
        "quick_orientation": [
            "Repo layout: top-level projects/ contains modular subprojects (each with a README.md). Key solutions: AllProjects.sln and projects/Projects.sln.",
            "Platform & tech: WinUI 3 + .NET 10 (C#), with some C++ projects (Oxygen.Engine). Many projects use source generators, MVVM patterns, and DI (see projects/Hosting/ and projects/Hosting.Generators/).",
            "Where to look first: module README.md, design/, and any design/*.md or plan/ docs for architecture and rationale."
        ],
        "style_and_conventions": [
            "Follow the repository C# style: see .github/instructions/csharp_coding_style.instructions.md (C# 13 preview, nullable on, ImplicitUsings, strict analysis).",
            "UI code follows MVVM and WinUI practices; prefer minimal code-behind and use ViewModels and source-generated wiring (see projects/Hosting/ and projects/Routing/).",
            "Always use explicit access modifiers (public, private, etc.) and this. for instance members.",
            "Prefer composition and small, well-justified API surfaces. When adding a public API, check src/*/Base or Oxygen.Base-like modules first."
        ],
        "architecture_highlights": [
            "Modular mono-repo: each projects/<Name>/ is a self-contained subsystem: Hosting, Routing, Docking, Mvvm.Generators, Hosting.Generators, Oxygen.Engine, Aura, Bootstrap, Collections, Config, Controls, Converters, Resources, TimeMachine.",
            "Many modules include their own .github/copilot-instructions.md or instructions/ — follow those local rules when working inside that module.",
            "Design docs live in plan/ and projects/**/design — use them to find the 'why' behind non-obvious decisions."
        ],
        "code_patterns": [
            "Source generators: check projects/Hosting.Generators and projects/Mvvm.Generators for how views/models/services are auto-wired — mimic patterns rather than inventing new generator usage.",
            "DI/container: DryIoc is used via the Hosting layer — prefer registering services in the standard host startup pattern found in projects/Hosting/README.md. Services are registered using Microsoft.Extensions.DependencyInjection patterns.",
            "MVVM patterns: ViewModels typically inherit from ObservableObject (CommunityToolkit.Mvvm) or framework base classes. Views are partial class with [ViewModel(typeof(TViewModel))] attribute for source-generated wiring.",
            "MVVM routing: projects/Routing/ provides router and registration conventions; look at existing route declarations before proposing changes. Routes support outlets (primary, modal, popup), matrix parameters, and hierarchical navigation.",
            "Docking: managed through Docker class with IDock, IDockable interfaces. Supports CenterDock and ToolDock types with tree-based layout."
        ],
        "build_system_and_structure": [
            "Artifacts output: Uses .NET 8+ simplified artifacts layout (UseArtifactsOutput=true). All build outputs go to top-level artifacts/ directory, organized by Configuration_TargetFramework[_RID].",
            "Central package management: Directory.Packages.props manages all NuGet versions centrally. Do not specify versions in individual .csproj files.",
            "Project naming: Test projects must end with .Tests. UI tests requiring visual interface must end with .UI.Tests.",
            "Project layout: Sources under src/, tests under tests/, samples under samples/.",
            "Solution generation: Solutions are generated using dotnet slngen. See projects/open.cmd for the pattern."
        ],
        "testing_and_test_projects": [
            "Tests use MSTest (not xUnit or NUnit). Use [TestClass], [TestMethod], [DataRow] attributes.",
            "Follow AAA (Arrange-Act-Assert) pattern with naming: MethodName_Scenario_ExpectedBehavior.",
            "See .github/prompts/csharp-mstest.prompt.md for detailed MSTest conventions.",
            "Test projects reference MSTest, MSTest.Analyzers, AwesomeAssertions, and optionally Moq for mocking.",
            "Use projects/TestHelpers/ for shared test utilities.",
            "Run tests with: dotnet test or dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat=lcov."
        ],
        "developer_workflows": [
            "Init script: Run init.ps1 only once after a fresh checkout to install the .NET SDK (when needed), restore tools, and set up pre-commit hooks.",
            "Prefer targeted builds: Each module contains its own .sln and multiple .csproj files. To save time, prefer building or testing a specific project file instead of the large solution.",
            "Generate/open solution: Use the repo helper in projects/ to regenerate and open the solution for Visual Studio (cd projects; .\\open.cmd).",
            "Clean build artifacts: .\\clean.ps1 removes obj/, bin/, and artifacts/ directories."
        ],
        "key_dependencies": [
            "WinUI 3: Microsoft.WindowsAppSDK 1.8+, target framework net10.0-windows10.0.26100.0",
            "DI: DryIoc 6.0 preview, Microsoft.Extensions.DependencyInjection/Hosting 10.0",
            "Logging: Serilog",
            "MVVM: CommunityToolkit.Mvvm 8.4",
            "Testing: MSTest 4.0, AwesomeAssertions, Moq",
            "Code quality: StyleCop.Analyzers, Roslynator, Meziantou.Analyzer",
            "Versioning: Nerdbank.GitVersioning reads from version.json"
        ],
        "what_to_avoid": [
            "Do not add broad, repo-wide public APIs without a design doc and cross-module review.",
            "Avoid suggesting shell commands that assume Bash; always use PowerShell on Windows.",
            "Do not manually specify package versions in .csproj files — they are centrally managed in Directory.Packages.props.",
            "Do not create test projects without the .Tests suffix.",
            "Do not use regions in test organization."
        ],
        "if_youre_unsure": [
            "Ask a focused question that references the module path (e.g., In projects/Hosting, should service X be registered as singleton or transient?).",
            "Read the local README.md and design/ docs before proposing architectural changes.",
            "Check for module-specific .github/copilot-instructions.md."
        ],
        "references": [
            ".github/instructions/csharp_coding_style.instructions.md",
            ".github/prompts/csharp-mstest.prompt.md",
            "projects/Oxygen.Engine/.github/copilot-instructions.md",
            "projects/*/README.md",
            "plan/",
            "Directory.Packages.props",
            "Directory.build.props"
        ]
    },
    "csharp_coding_style": {
        "applyTo": "**/*.cs",
        "rules": [
            "Use C# 13 with preview features enabled.",
            "DO NOT EVER attempt to reorder members in a class, even when the analyzer warns about that.",
            "Use explicit access modifiers for all types and members (public, private, protected, internal).",
            "Always use braces {} for control statements (if, else, for, while, etc.), even for single-line statements.",
            "Use var for local variable declarations when the type is obvious from the right-hand side. Otherwise, use explicit types.",
            "Use expression-bodied members for simple properties and methods where appropriate.",
            "Always use this. to reference instance members to improve code readability.",
            "Respect the rules in .editorconfig (../../.editorconfig), unless they conflict with previous instructions."
        ],
        "language_options": {
            "LangVersion": "preview",
            "Features": "Strict",
            "Nullable": "enable",
            "ImplicitUsings": "enable",
            "EnforceExtendedAnalyzerRules": false,
            "WarningLevel": 999,
            "NoWarn": "$(NoWarn),1573,1591,1712",
            "WarningsAsErrors": "nullable",
            "DefaultLanguage": "en-US",
            "AnalysisLevel": "latest",
            "AnalysisMode": "All",
            "EnforceCodeStyleInBuild": true
        },
        "winui3_guidelines": [
            "Follow the MVVM (Model-View-ViewModel) pattern for UI development.",
            "Use data binding for UI elements instead of code-behind manipulation whenever possible.",
            "Keep the code-behind files minimal; most logic should reside in ViewModels.",
            "Act as an experienced WinUI 3 developer, providing best practices and patterns for building modern Windows applications.",
            "Use theme-aware resources for colors, fonts, and styles to ensure consistency across light and dark modes.",
            "Know and follow the latest WinUI 3 design and style guidelines and recommendations from Microsoft."
        ]
    }
}
