// Distributed under the MIT License. See accompanying file LICENSE or copy
// at https://opensource.org/licenses/MIT.
// SPDX-License-Identifier: MIT

using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.Drawing;
using Oxygen.Editor.Data;
using Oxygen.Editor.Data.Models;

namespace Oxygen.Editor.ProjectBrowser;

/// <summary>
/// Represents the settings for the Project Browser module in the Oxygen Editor.
/// </summary>
/// <remarks>
/// <para>
/// The <see cref="ProjectBrowserSettings"/> class extends the <see cref="ModuleSettings"/> class to
/// include properties specific to the Project Browser module, including window position, size, opacity,
/// and project browser-specific settings. These properties are automatically persisted and retrieved
/// using the settings manager when saved and loaded.
/// </para>
/// <para>
/// The descriptors for these settings are automatically generated by the source generator based on
/// the <see cref="PersistedAttribute"/> and metadata attributes applied to the properties.
/// </para>
/// </remarks>
internal sealed partial class ProjectBrowserSettings : ModuleSettings
{
    private new const string ModuleName = "Oxygen.Editor.ProjectBrowser";

    private Point windowPosition = new(100, 100);
    private Size windowSize = new(800, 600);
    private string lastSaveLocation = string.Empty;

    /// <summary>
    /// Initializes a new instance of the <see cref="ProjectBrowserSettings"/> class.
    /// </summary>
    public ProjectBrowserSettings()
        : base(ModuleName)
    {
    }

    /// <summary>
    /// Gets or sets the window position.
    /// </summary>
    /// <value>
    /// A <see cref="Point"/> representing the window position.
    /// </value>
    [Persisted]
    [Display(Name = "Window Position", Description = "The position of the Project Browser window")]
    [Category("Layout")]
    public Point WindowPosition
    {
        get => this.windowPosition;
        set => this.SetProperty(ref this.windowPosition, value);
    }

    /// <summary>
    /// Gets or sets the window size.
    /// </summary>
    /// <value>
    /// A <see cref="Size"/> representing the window size.
    /// </value>
    [Persisted]
    [Display(Name = "Window Size", Description = "The size of the Project Browser window")]
    [Category("Layout")]
    public Size WindowSize
    {
        get => this.windowSize;
        set => this.SetProperty(ref this.windowSize, value);
    }

    /// <summary>
    /// Gets or sets the last location where a project was saved.
    /// </summary>
    /// <value>
    /// A <see cref="string"/> representing the last save location.
    /// </value>
    [Persisted]
    [Display(Name = "Last Save Location", Description = "The last location where a project was saved")]
    [Category("Recent")]
    public string LastSaveLocation
    {
        get => this.lastSaveLocation;
        set => this.SetProperty(ref this.lastSaveLocation, value);
    }
}
