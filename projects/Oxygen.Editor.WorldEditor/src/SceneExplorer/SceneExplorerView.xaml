<?xml version="1.0" encoding="utf-8" ?>
<UserControl
    x:Class="Oxygen.Editor.WorldEditor.SceneExplorer.SceneExplorerView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dnc="using:DroidNet.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:scene="using:Oxygen.Editor.WorldEditor.SceneExplorer"
    xmlns:utils="using:Oxygen.Editor.WorldEditor.Utils"
    KeyboardAcceleratorPlacementMode="Hidden"
    mc:Ignorable="d">

    <UserControl.Resources>
        <ResourceDictionary>
            <DataTemplate x:Key="SceneThumbnailTemplate" x:DataType="dnc:TreeItemAdapter">
                <Image Source="{x:Bind utils:ThumbnailGenerator.GenerateRandomImage(24, 24)}" />
            </DataTemplate>

            <DataTemplate x:Key="EntityThumbnailTemplate" x:DataType="dnc:TreeItemAdapter">
                <SymbolIcon
                    Width="24"
                    Height="24"
                    Symbol="{x:Bind utils:ThumbnailGenerator.GetThumbnailForEntity((dnc:TreeItemAdapter))}" />
            </DataTemplate>

            <DataTemplate x:Key="FolderThumbnailTemplate" x:DataType="scene:FolderAdapter">
                <FontIcon
                    Width="24"
                    Height="24"
                    Glyph="{x:Bind IconGlyph, Mode=OneWay}" />
            </DataTemplate>

            <utils:ThumbnailTemplateSelector
                x:Key="ThumbnailTemplateSelector"
                EntityTemplate="{StaticResource EntityThumbnailTemplate}"
                FolderTemplate="{StaticResource FolderThumbnailTemplate}"
                SceneTemplate="{StaticResource SceneThumbnailTemplate}" />

        </ResourceDictionary>
    </UserControl.Resources>

    <UserControl.KeyboardAccelerators>
        <KeyboardAccelerator
            Key="Z"
            Invoked="UndoInvoked"
            Modifiers="Control" />
        <KeyboardAccelerator
            Key="Y"
            Invoked="RedoInvoked"
            Modifiers="Control" />
        <KeyboardAccelerator Key="Delete" Invoked="DeleteInvoked" />
    </UserControl.KeyboardAccelerators>

    <Grid
        Padding="4"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Border
            Padding="0,3"
            BorderBrush="Red"
            BorderThickness="1"
            CornerRadius="3">
            <dnc:DynamicTree ThumbnailTemplateSelector="{StaticResource ThumbnailTemplateSelector}" ViewModel="{x:Bind ViewModel}" />
        </Border>
        <Grid Grid.Row="1">
            <Grid.Resources>
                <Style TargetType="AppBarButton">
                    <Setter Property="Width" Value="40" />
                </Style>
            </Grid.Resources>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <dnc:ToolBar
                Grid.Column="1"
                DefaultLabelPosition="Collapsed"
                IsCompact="False"
                OverflowButtonVisibility="Collapsed">
                <dnc:ToolBar.PrimaryItems>
                    <!--  New scene node  -->
                    <dnc:ToolBarButton Command="{x:Bind ViewModel.AddEntityCommand}" Label="New Node">
                        <dnc:ToolBarButton.Icon>
                            <SymbolIconSource Symbol="Add" />
                        </dnc:ToolBarButton.Icon>
                    </dnc:ToolBarButton>

                    <!--  New folder from selection  -->
                    <dnc:ToolBarButton
                        Command="{x:Bind ViewModel.CreateFolderFromSelectionCommand}"
                        IsEnabled="{x:Bind ViewModel.HasUnlockedSelectedItems, Mode=OneWay}"
                        Label="New Folder">
                        <dnc:ToolBarButton.Icon>
                            <SymbolIconSource Symbol="Folder" />
                        </dnc:ToolBarButton.Icon>
                    </dnc:ToolBarButton>

                    <dnc:ToolBarSeparator />

                    <!--  Rename / Cut / Copy / Paste / Delete  -->
                    <dnc:ToolBarButton Click="Rename_Click" Label="Rename">
                        <dnc:ToolBarButton.Icon>
                            <SymbolIconSource Symbol="Rename" />
                        </dnc:ToolBarButton.Icon>
                    </dnc:ToolBarButton>

                    <dnc:ToolBarButton Click="Cut_Click" Label="Cut">
                        <dnc:ToolBarButton.Icon>
                            <SymbolIconSource Symbol="Cut" />
                        </dnc:ToolBarButton.Icon>
                    </dnc:ToolBarButton>

                    <dnc:ToolBarButton Click="Copy_Click" Label="Copy">
                        <dnc:ToolBarButton.Icon>
                            <SymbolIconSource Symbol="Copy" />
                        </dnc:ToolBarButton.Icon>
                    </dnc:ToolBarButton>

                    <dnc:ToolBarButton Click="Paste_Click" Label="Paste">
                        <dnc:ToolBarButton.Icon>
                            <SymbolIconSource Symbol="Paste" />
                        </dnc:ToolBarButton.Icon>
                    </dnc:ToolBarButton>

                    <dnc:ToolBarButton
                        Command="{x:Bind ViewModel.RemoveSelectedItemsCommand}"
                        Label="Delete"
                        ToolTipService.ToolTip="Delete (Del)">
                        <dnc:ToolBarButton.Icon>
                            <SymbolIconSource Symbol="Delete" />
                        </dnc:ToolBarButton.Icon>
                    </dnc:ToolBarButton>
                </dnc:ToolBar.PrimaryItems>
            </dnc:ToolBar>
        </Grid>
    </Grid>
</UserControl>
